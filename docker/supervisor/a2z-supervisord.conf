[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
user=root

[program:postgresql]
command=su-exec postgres postgres -D /var/lib/postgresql/data -k /run/postgresql
autostart=true
autorestart=true
priority=100
stdout_logfile=/var/log/supervisor/postgresql.log
stderr_logfile=/var/log/supervisor/postgresql_error.log

[program:redis]
command=redis-server /etc/redis.conf
user=redis
autostart=true
autorestart=true
priority=100
stdout_logfile=/var/log/supervisor/redis.log
stderr_logfile=/var/log/supervisor/redis_error.log

[program:api]
command=/usr/local/bin/node index.js
directory=/app/api
autostart=true
autorestart=true
priority=300
user=root
environment=NODE_ENV="development",PORT="3001",DATABASE_URL="postgresql://postgres@localhost:5432/a2z_soc",REDIS_URL="redis://:redis_password@localhost:6379/0"
stdout_logfile=/var/log/supervisor/api.log
stderr_logfile=/var/log/supervisor/api_error.log

[program:network-agent]
command=/usr/local/bin/node standalone-server.js
directory=/app/agents/network-agent
autostart=true
autorestart=true
priority=300
user=root
environment=NODE_ENV="development",PORT="5200",A2Z_INTERFACE="any",A2Z_STANDALONE="true"
stdout_logfile=/var/log/supervisor/network-agent.log
stderr_logfile=/var/log/supervisor/network-agent_error.log

[program:frontend]
command=/usr/local/bin/npm run dev -- --host 0.0.0.0 --port 5173
directory=/app
autostart=true
autorestart=true
priority=300
user=root
environment=NODE_ENV="development"
stdout_logfile=/var/log/supervisor/frontend.log
stderr_logfile=/var/log/supervisor/frontend_error.log 